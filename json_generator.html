<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON & Sitemap Generator for Bookdown</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple transition for feedback */
        .feedback-button {
            transition: background-color 0.3s ease;
        }
        /* Hide element by default */
        .hidden-initially {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-6xl">
        <div class="bg-white p-8 rounded-2xl shadow-lg">

            <header class="mb-8 text-center">
                <h1 class="text-3xl font-bold text-gray-900">Bookdown Site Generator</h1>
                <p class="text-gray-600 mt-2">Fill in the form below and click "Generate" to create the JSON and Sitemap snippets.</p>
            </header>

            <!-- Main form for user input -->
            <form id="json-form" class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">

                <!-- Column 1 -->
                <div class="space-y-6">
                    <div>
                        <label for="url" class="block text-sm font-medium text-gray-700 mb-1">Workshop Code</label>
                        <input type="text" id="url" name="url" placeholder="INR_MonVir-2611" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1">Your workshop code</p>
                    </div>
                    <div>
                        <label for="title" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                        <input type="text" id="title" name="title" placeholder="Introduction to R" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1 invisible">placeholder</p>
                    </div>
                    <div>
                        <label for="instructors" class="block text-sm font-medium text-gray-700 mb-1">Instructors</label>
                        <input type="text" id="instructors" name="instructors" placeholder="Jane Doe, John Smith" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1">Separate multiple names with a comma.</p>
                    </div>
                    <div>
                        <label for="tags" class="block text-sm font-medium text-gray-700 mb-1">Tags</label>
                        <input type="text" id="tags" name="tags" placeholder="Data Science, R, Statistics" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1">Separate multiple tags with a comma.</p>
                    </div>
                     <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Regions</label>
                        <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 mt-2">
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" name="regions" value="BC" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                <span>BC</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" name="regions" value="Alberta" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                <span>Alberta</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" name="regions" value="Prairies" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                <span>Prairies</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" name="regions" value="Ontario" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                <span>Ontario</span>
                            </label>
                             <label class="flex items-center space-x-2">
                                <input type="checkbox" name="regions" value="Quebec" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                <span>Quebec</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" name="regions" value="Atlantic" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                <span>Atlantic</span>
                            </label>
                             <label class="flex items-center space-x-2">
                                <input type="checkbox" name="regions" value="Online" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                <span>Online</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Column 2 -->
                <div class="space-y-6">
                    <div>
                        <label for="startDate" class="block text-sm font-medium text-gray-700 mb-1">Start Date</label>
                        <input type="date" id="startDate" name="startDate" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1 invisible">placeholder</p>
                    </div>
                     <div>
                        <label for="endDate" class="block text-sm font-medium text-gray-700 mb-1">End Date</label>
                        <input type="date" id="endDate" name="endDate" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1 invisible">placeholder</p>
                    </div>
                    <div>
                        <label for="year" class="block text-sm font-medium text-gray-700 mb-1">Year</label>
                        <input type="number" id="year" name="year" placeholder="YYYY" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1">Auto-filled from Start Date.</p>
                    </div>
                    <div>
                        <label for="image" class="block text-sm font-medium text-gray-700 mb-1">Image Filename</label>
                        <input type="text" id="image" name="image" placeholder="YOURIMAGE.png" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1 invisible">placeholder</p>
                    </div>
                    <div>
                        <label for="location" class="block text-sm font-medium text-gray-700 mb-1">Location(s)</label>
                        <input type="text" id="location" name="location" placeholder="MontrÃ©al QC, Virtual" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <p class="text-xs text-gray-500 mt-1">Format is [City] [Province Abbreviation]. Separate multiple locations with a comma.</p>
                    </div>
                     <div>
                        <label for="format" class="block text-sm font-medium text-gray-700 mb-1">Format</label>
                        <select id="format" name="format" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="" disabled selected>Select a format</option>
                            <option value="Online">Online</option>
                            <option value="In-person">In-person</option>
                            <option value="Distributed">Distributed</option>
                            <option value="Hybrid">Hybrid</option>
                            <option value="Asynchronous">Asynchronous</option>
                            <option value="Flipped">Flipped</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-1 invisible">placeholder</p>
                    </div>
                </div>
            </form>

            <!-- Generate Button -->
            <div class="mt-8 text-center">
                <button id="generate-button" class="px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Generate Snippets
                </button>
            </div>

            <!-- JSON Output section -->
            <div id="output-container" class="mt-10 hidden-initially">
                <div class="flex justify-between items-center mb-2">
                    <h2 class="text-xl font-semibold text-gray-900">Generated JSON</h2>
                    <button id="copy-button" class="feedback-button px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Copy
                    </button>
                </div>
                <div class="bg-gray-900 rounded-lg p-4">
                    <pre><code id="output" class="text-sm text-gray-100 whitespace-pre-wrap break-all"></code></pre>
                </div>
            </div>

            <!-- Sitemap XML Output section -->
            <div id="sitemap-output-container" class="mt-8 hidden-initially">
                <div class="flex justify-between items-center mb-2">
                    <h2 class="text-xl font-semibold text-gray-900">Generated Sitemap XML</h2>
                    <button id="copy-sitemap-button" class="feedback-button px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Copy
                    </button>
                </div>
                <div class="bg-gray-900 rounded-lg p-4">
                    <pre><code id="sitemap-output" class="text-sm text-gray-100 whitespace-pre-wrap break-all"></code></pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Get references to all the necessary DOM elements
        const form = document.getElementById('json-form');
        const generateButton = document.getElementById('generate-button');

        // JSON elements
        const outputContainer = document.getElementById('output-container');
        const outputElement = document.getElementById('output');
        const copyButton = document.getElementById('copy-button');

        // Sitemap XML elements
        const sitemapOutputContainer = document.getElementById('sitemap-output-container');
        const sitemapOutputElement = document.getElementById('sitemap-output');
        const copySitemapButton = document.getElementById('copy-sitemap-button');

        // Helper function to parse comma-separated strings into an array
        const parseToArray = (str) => {
            if (!str) return [];
            return str.split(',').map(item => item.trim()).filter(item => item);
        };

        // Function to generate the JSON output
        const generateJson = () => {
            const formData = new FormData(form);

            // Get selected regions from checkboxes
            const selectedRegions = Array.from(form.querySelectorAll('input[name="regions"]:checked')).map(cb => cb.value);

            const data = {
                url: formData.get('url') || "",
                title: formData.get('title') || "",
                instructors: parseToArray(formData.get('instructors')),
                tags: parseToArray(formData.get('tags')),
                regions: selectedRegions,
                year: parseInt(formData.get('year'), 10) || null,
                startDate: formData.get('startDate') || "",
                endDate: formData.get('endDate') || "",
                image: formData.get('image') ? `img/${formData.get('image')}` : "img/YOURIMAGE.png",
                location: parseToArray(formData.get('location')),
                format: formData.get('format') || ""
            };
            const jsonString = JSON.stringify(data, null, 4);
            outputElement.textContent = jsonString;
        };

        // Function to generate the Sitemap XML output
        const generateSitemapXml = () => {
            const formData = new FormData(form);
            const urlPath = formData.get('url') || "";
            const fullUrl = `https://bioinformaticsdotca.github.io/${urlPath}`;
            const xmlString = `  <url>\n    <loc>${fullUrl}</loc>\n  </url>`;
            sitemapOutputElement.textContent = xmlString;
        };

        // Auto-update the year field when the start date changes
        const startDateInput = document.getElementById('startDate');
        const yearInput = document.getElementById('year');
        startDateInput.addEventListener('input', () => {
            const dateValue = startDateInput.value;
            if (dateValue) {
                yearInput.value = new Date(dateValue).getFullYear();
            }
        });

        // Event listener for the generate button
        generateButton.addEventListener('click', () => {
            generateJson();
            generateSitemapXml();
            // Show both output containers
            outputContainer.style.display = 'block';
            sitemapOutputContainer.style.display = 'block';
        });

        // Generic copy function for buttons
        const setupCopyButton = (button, output) => {
             button.addEventListener('click', () => {
                const textToCopy = output.textContent;
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = textToCopy;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();

                try {
                    document.execCommand('copy');
                    const originalText = button.textContent;
                    button.textContent = 'Copied!';
                    button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                    button.classList.add('bg-green-500');

                    setTimeout(() => {
                        button.textContent = originalText;
                        button.classList.remove('bg-green-500');
                        button.classList.add('bg-blue-600', 'hover:bg-blue-700');
                    }, 2000);

                } catch (err) {
                    console.error('Failed to copy text: ', err);
                }

                document.body.removeChild(tempTextArea);
            });
        };

        // Set up both copy buttons
        setupCopyButton(copyButton, outputElement);
        setupCopyButton(copySitemapButton, sitemapOutputElement);

    </script>
</body>
</html>
